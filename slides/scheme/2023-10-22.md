# Differences between Stak and Ribbit Scheme

[@raviqqe](https://github.com/raviqqe)

October 22, 2023

---

# Contents

- Overview of Ribbit Scheme
- Overview of Stak Scheme

---

# Ribbit Scheme

- A small and portable R4RS implementation
- Bytecode compiler and VM
- Instructions and primitive functions
- Everything is on heap.
  - Only integers and cons's
  - Bytecodes are lists.
  - A stack is a list.
  - A set of symbols is an association list.
- For host languages not equipped with native garbage collections (GC,) it
  provides moving GC.

---

# Stak Scheme

- A fork of Ribbit Scheme
- Its overall framework is the same as Ribbit Scheme.
- Some details deviated from Ribbit Scheme.
- There are many missing features from Ribbit Scheme.
  - e.g. incremental compilation and variadic instruction encoding

---

# Primitive functions

- In Ribbit Scheme, primitive functions push.
- In Stak Scheme, this is a part of calling convention.

---

# `apply` procedure

- In Ribbit Scheme, this is a primitive function.
- In Stak Scheme, this is a part of calling convention.

| Arguments | Parameters | Algorithm                                                      |
| --------- | ---------- | -------------------------------------------------------------- |
| Fixed     | Fixed      | Compare an argument count                                      |
| Fixed     | Variadic   | Stuff overflown arguments into a list (1)                      |
| Variadic  | Fixed      | Fill missing parameters with elements in the last argument (2) |
| Variadic  | Variadic   | (1) and (2)                                                    |

---

# Skip encoding

- In Ribbit Scheme, this is a primitive function.
- In Stak Scheme, this is a part of calling convention.

---

# Progress

- Record type
- Dynamic wind
- Parameter object
- Exception
- Website at https://raviqqe.github.io/stak/

---

# Next tasks...

- Self-hosting
- Library system
