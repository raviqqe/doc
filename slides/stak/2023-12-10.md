# Testing a self-hosted compiler in Stak

[@raviqqe](https://github.com/raviqqe)

December 10, 2023

---

# Contents

- Self hosting in Stak
- Testing a self-hosted Stak
- Progress
- Future work

---

# Self hosting in Stak

- Self hosting is to write a language processor by the language the processor can process.
  - e.g. A C compiler written in C can compile itself and then compile any C source codes by the compiled compiler.
- Stak's compiler is now self-hosted.

---

# Design bug in the language

## Problem

- I assumed that some identifiers can be reserved for special use by a compiler and a standard library.
- But then, those reserved identifiers cannot be used by the compiler when it's self-hosted.
  - Paradox!

---

# Design bug in the language

## (Temporary) solution

- Handle those reserved identifiers in a special way.
- Empty symbols can be empty anyway.
- When we find construction of `$$foo`, we do not try to find them in a symbol table.
- But we rather directly map them to `$$foo` symbols in environment.

```scheme
(define (string->symbol x)
  (cond
    ((equal? x "$$rib")
      '$$rib)

    ...

    (else
      (let ((pair (member x symbol-table (lambda (x y) (equal? x (symbol->string y))))))
        ...))))
```

---

# Progress

- Self-hosted compiler

---

# Future work

- `eval` procedure
- Library system

---

# Summary

- Self hosting is fun! ðŸ˜„
- Testing self hosting is kind of fun. ðŸ˜ƒ
